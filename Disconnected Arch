namespace dotnetapp.Models
{
    public class Car
    {
        public int CarID { get; set; }
        public string Make { get; set; }
        public string Model { get; set; }
        public DateTime DateAdded { get; set; }
    }
}

// if table has to be deleted at each time we run the code-
Drop TABLE IF EXISTS Cars;

CREATE TABLE Cars (
    CarID INT PRIMARY KEY IDENTITY(1,1),
    Make NVARCHAR(50),
    Model NVARCHAR(50),
    DateAdded DATETIME
);



using System;
using System.Data;
using System.Data.SqlClient;
using dotnetapp.Models;

namespace dotnetapp
{
    public static class ConnectionStringProvider
    {
        public static string ConnectionString { get; } = "User ID=sa;password=examlyMssql@123;server=localhost;Database=appdb;trusted_connection=false;Persist Security Info=False;Encrypt=False";
    }

    public class Program
    {
        static string connectionString = ConnectionStringProvider.ConnectionString;

        public static void AddCar(Car car)
        {
            using (SqlConnection con = new SqlConnection(connectionString))
            {
                SqlDataAdapter adp = new SqlDataAdapter("SELECT * FROM Cars", con);
                DataSet ds = new DataSet();
                adp.Fill(ds, "Cars");
                DataTable dt = ds.Tables["Cars"];

                DataRow dr = dt.NewRow();
                dr["Make"] = car.Make;
                dr["Model"] = car.Model;
                dr["DateAdded"] = car.DateAdded;

                dt.Rows.Add(dr);
                SqlCommandBuilder builder = new SqlCommandBuilder(adp);
                adp.Update(ds, "Cars");
                Console.WriteLine("Car added successfully.");
            }
        }

        public static void ListCars()
        {
            using (SqlConnection con = new SqlConnection(connectionString))
            {
                SqlDataAdapter adp = new SqlDataAdapter("SELECT * FROM Cars", con);
                DataSet ds = new DataSet();
                adp.Fill(ds, "Cars");
                DataTable dt = ds.Tables["Cars"];

                if (dt.Rows.Count == 0)
                {
                    Console.WriteLine("No cars available.");
                    return;
                }

                foreach (DataRow row in dt.Rows)
                {
                    Console.WriteLine($"{row["CarID"]}, {row["Make"]}, {row["Model"]}, {row["DateAdded"]}");
                }
            }
        }

        public static void DeleteCar(int carID)
        {
            using (SqlConnection con = new SqlConnection(connectionString))
            {
                SqlDataAdapter adp = new SqlDataAdapter("SELECT * FROM Cars", con);
                DataSet ds = new DataSet();
                adp.Fill(ds, "Cars");
                DataTable dt = ds.Tables["Cars"];

                foreach (DataRow row in dt.Rows)
                {
                    if ((int)row["CarID"] == carID)
                    {
                        row.Delete();
                        break;
                    }
                }

                SqlCommandBuilder builder = new SqlCommandBuilder(adp);
                adp.Update(ds, "Cars");
                Console.WriteLine("Car deleted successfully.");
            }
        }

        public static void SearchCarWithMake(string make)
        {
            using (SqlConnection con = new SqlConnection(connectionString))
            {
                SqlDataAdapter adp = new SqlDataAdapter("SELECT * FROM Cars", con);
                DataSet ds = new DataSet();
                adp.Fill(ds, "Cars");
                DataTable dt = ds.Tables["Cars"];

                foreach (DataRow row in dt.Rows)
                {
                    if (row["Make"].ToString().Equals(make, StringComparison.OrdinalIgnoreCase))
                    {
                        Console.WriteLine($"{row["CarID"]}, {row["Make"]}, {row["Model"]}, {row["DateAdded"]}");
                    }
                }
            }
        }

        public static void SearchCarWithModel(string model)
        {
            using (SqlConnection con = new SqlConnection(connectionString))
            {
                SqlDataAdapter adp = new SqlDataAdapter("SELECT * FROM Cars", con);
                DataSet ds = new DataSet();
                adp.Fill(ds, "Cars");
                DataTable dt = ds.Tables["Cars"];

                foreach (DataRow row in dt.Rows)
                {
                    if (row["Model"].ToString().Equals(model, StringComparison.OrdinalIgnoreCase))
                    {
                        Console.WriteLine($"{row["CarID"]}, {row["Make"]}, {row["Model"]}, {row["DateAdded"]}");
                    }
                }
            }
        }

        public static void ShowTopNRecords(int n)
        {
            using (SqlConnection con = new SqlConnection(connectionString))
            {
                SqlDataAdapter adp = new SqlDataAdapter("SELECT * FROM Cars ORDER BY DateAdded DESC", con);
                DataSet ds = new DataSet();
                adp.Fill(ds, "Cars");
                DataTable dt = ds.Tables["Cars"];

                for (int i = 0; i < Math.Min(n, dt.Rows.Count); i++)
                {
                    DataRow row = dt.Rows[i];
                    Console.WriteLine($"{row["CarID"]}, {row["Make"]}, {row["Model"]}, {row["DateAdded"]}");
                }
            }
        }

        public static void ShowBottomNRecords(int n)
        {
            using (SqlConnection con = new SqlConnection(connectionString))
            {
                SqlDataAdapter adp = new SqlDataAdapter("SELECT * FROM Cars ORDER BY DateAdded ASC", con);
                DataSet ds = new DataSet();
                adp.Fill(ds, "Cars");
                DataTable dt = ds.Tables["Cars"];

                for (int i = 0; i < Math.Min(n, dt.Rows.Count); i++)
                {
                    DataRow row = dt.Rows[i];
                    Console.WriteLine($"{row["CarID"]}, {row["Make"]}, {row["Model"]}, {row["DateAdded"]}");
                }
            }
        }

        public static void ShowCarsInDateRange(DateTime startDate, DateTime endDate)
        {
            using (SqlConnection con = new SqlConnection(connectionString))
            {
                SqlDataAdapter adp = new SqlDataAdapter("SELECT * FROM Cars", con);
                DataSet ds = new DataSet();
                adp.Fill(ds, "Cars");
                DataTable dt = ds.Tables["Cars"];

                foreach (DataRow row in dt.Rows)
                {
                    DateTime date = Convert.ToDateTime(row["DateAdded"]);
                    if (date >= startDate && date <= endDate)
                    {
                        Console.WriteLine($"{row["CarID"]}, {row["Make"]}, {row["Model"]}, {row["DateAdded"]}");
                    }
                }
            }
        }

        public static void UpdateCar(int carID, string newMake, string newModel, DateTime newDateAdded)
        {
            using (SqlConnection con = new SqlConnection(connectionString))
            {
                SqlDataAdapter adp = new SqlDataAdapter("SELECT * FROM Cars", con);
                DataSet ds = new DataSet();
                adp.Fill(ds, "Cars");
                DataTable dt = ds.Tables["Cars"];

                bool found = false;
                foreach (DataRow row in dt.Rows)
                {
                    if ((int)row["CarID"] == carID)
                    {
                        row["Make"] = newMake;
                        row["Model"] = newModel;
                        row["DateAdded"] = newDateAdded;
                        found = true;
                        break;
                    }
                }

                if (!found)
                {
                    Console.WriteLine("Car not found.");
                    return;
                }

                SqlCommandBuilder builder = new SqlCommandBuilder(adp);
                adp.Update(ds, "Cars");
                Console.WriteLine("Car updated successfully.");
            }
        }

        public static void GetCarById(int carID)
        {
            using (SqlConnection con = new SqlConnection(connectionString))
            {
                SqlDataAdapter adp = new SqlDataAdapter("SELECT * FROM Cars", con);
                DataSet ds = new DataSet();
                adp.Fill(ds, "Cars");
                DataTable dt = ds.Tables["Cars"];

                foreach (DataRow row in dt.Rows)
                {
                    if ((int)row["CarID"] == carID)
                    {
                        Console.WriteLine($"{row["CarID"]}, {row["Make"]}, {row["Model"]}, {row["DateAdded"]}");
                        return;
                    }
                }

                Console.WriteLine("Car not found.");
            }
        }

        public static void CountCars()
        {
            using (SqlConnection con = new SqlConnection(connectionString))
            {
                SqlDataAdapter adp = new SqlDataAdapter("SELECT * FROM Cars", con);
                DataSet ds = new DataSet();
                adp.Fill(ds, "Cars");
                int count = ds.Tables["Cars"].Rows.Count;
                Console.WriteLine($"Total number of cars: {count}");
            }
        }

        public static void Main(string[] args)
        {
            bool exit = false;
            while (!exit)
            {
                Console.WriteLine("\nMenu");
                Console.WriteLine("1 - Add Car");
                Console.WriteLine("2 - List Cars");
                Console.WriteLine("3 - Delete Car");
                Console.WriteLine("4 - SearchCarWithMake_Option1");
                Console.WriteLine("5 - SearchCarWithModel_Option1");
                Console.WriteLine("6 - Show Top n Records");
                Console.WriteLine("7 - Show Bottom n Records");
                Console.WriteLine("8 - Show Cars In Date Range");
                Console.WriteLine("9 - Update Car");
                Console.WriteLine("10 - Get Car By ID");
                Console.WriteLine("11 - Count Cars");
                Console.WriteLine("12 - Exit");
                Console.Write("Enter your choice 



using System.Data;
using System.Globalization;
using ConsoleApp1.Models;
using Microsoft.Data.SqlClient;

namespace ConsoleApp1
{
    internal class Program
    {
        public static class ConnectionStringProvider
        {
            public static string ConnectionString { get; }
            = "server=localhost;Database=LTIMindTreeDotNetTraining;integrated security=true;TrustServerCertificate=true";
        }

        public class Program1
        {
            public static string connectionString = ConnectionStringProvider.ConnectionString;
            static int id = 0;
            public static void Main(string[] args)
            {
                while (true)
                {
                    Console.WriteLine("Menu:");
                    Console.WriteLine("1 - Add Car");
                    Console.WriteLine("2 - List Cars");
                    Console.WriteLine("3 - Delete Car");
                    Console.WriteLine("4 - SearchCarWithThresholdValue");
                    Console.WriteLine("5 - SearchCarWithPatternMatching");
                    Console.WriteLine("6 - SearchCarWithModel_Option1");
                    Console.WriteLine("7 - Show Top n Records");
                    Console.WriteLine("8 - Show Bottom n Records");
                    Console.WriteLine("9 - Show Cars In Date Range");
                    Console.WriteLine("10 - Participant Exam Eligibility");
                    Console.WriteLine("11 - Exit");
                    Console.Write("Enter your choice: ");

                    string choice = Console.ReadLine();

                    switch (choice)
                    {
                        case "1":
                            //Console.Write("Enter Car ID: ");
                            // int id = int.Parse(Console.ReadLine());

                            Console.Write("Enter Car Make: ");
                            string carmake = Console.ReadLine();

                            Console.Write("Enter Car Model: ");
                            string model = Console.ReadLine();

                            Console.Write("Enter Year: ");
                            int year = int.Parse(Console.ReadLine());

                            Console.Write("Enter Service Date (dd-MM-yyyy): ");
                            string serviceDate = Console.ReadLine();

                            //Car car = new Car(carmake, model, year, serviceDate);
                            Car objCar = new Car();
                            objCar.CarMake = carmake;
                            objCar.CarModel = model;
                            objCar.Year = year;
                            objCar.ServiceDate = serviceDate;
                            //AddCar(objCar);
                            AddCarWithIdentity(objCar);
                            break;

                        case "2":
                            ListCars();
                            break;

                        case "3":
                            Console.Write("Enter the CarID of the car to delete: ");
                            int carID = int.Parse(Console.ReadLine());
                            DeleteCar(carID);
                            break;
                        case "4":
                            //Search By Make
                            Console.Write("Enter the threshold value to search car records: ");
                            string thresholdValue = Console.ReadLine();
                            SearchCarWithThreshold(thresholdValue);
                            break;
                        case "5":
                            //Search By Pattern Matching
                            Console.Write("Enter the pattern to search car records: ");
                            string patternValue = Console.ReadLine();
                            SearchCarWithPatternMatching(patternValue);
                            break;
                        case "6":
                            //Search By Model
                            Console.Write("Enter the Model of the car to Search: ");
                            string carModelSearch1 = Console.ReadLine();
                            SearchCarWithModel(carModelSearch1);
                            break;
                        case "7":
                            //Show Top n Recoreds
                            Console.Write("Enter no of rows to select from top: ");
                            //int count = int.Parse(Console.ReadLine());
                            string countInput = Console.ReadLine();
                            GetTopRecords(countInput);
                            break;
                        case "8":
                            //Show Bottom n Recoreds
                            Console.Write("Enter no of rows to select from bottom:");
                            int countBottom = int.Parse(Console.ReadLine());
                            GetBottomRecords(countBottom);
                            break;
                        case "9":
                            //Show Cars In Date Range
                            Console.Write("Enter the ServiceStartDate of the car: ");
                            string serviceStartDate = Console.ReadLine();
                            Console.Write("Enter the ServiceEndDate of the car: ");
                            string serviceEndDate = Console.ReadLine();
                            //
                            SearchCarWithServiceDateRange(serviceStartDate, serviceEndDate);
                            break;
                        case "10":
                            //Participant Exam Eligibility
                            ParticipantExamEligibility();
                            Console.WriteLine("Participant Exam Eligibility updated successfully.");
                            break;
                        case "11":
                            return;
                        default:
                            Console.WriteLine("Invalid choice");
                            break;
                    }
                }

            }

            public static void AddCar(Car v)
            {

                using (SqlConnection connection = new SqlConnection(connectionString))
                {
                    connection.Open();
                    //
                    SqlCommand command = new SqlCommand("SELECT * FROM Cars WHERE CarID = @CarID", connection);
                    command.Parameters.AddWithValue("@CarID", v.CarID);
                    SqlDataAdapter adapter = new SqlDataAdapter();
                    adapter.SelectCommand = command;
                    DataSet dataSet = new DataSet();
                    adapter.Fill(dataSet);

                    if (dataSet.Tables[0].Rows.Count > 0)
                    {
                        Console.WriteLine($"A car with ID {v.CarID} already exists.");
                        return;
                    }

                    command.CommandText = "INSERT INTO Cars (CarMake, CarModel, Year, ServiceDate) VALUES (@Make, @Model, @Year, @serviceDate)";
                    command.Parameters.AddWithValue("@Make", v.CarMake);
                    command.Parameters.AddWithValue("@Model", v.CarModel);
                    command.Parameters.AddWithValue("@Year", v.Year);
                    command.Parameters.AddWithValue("@serviceDate", v.ServiceDate);

                    command.ExecuteNonQuery();
                    Console.WriteLine("Car added successfully.");
                }
            }

            public static void AddCarWithIdentity(Car v)
            {

                using (SqlConnection connection = new SqlConnection(connectionString))
                {
                   
                    SqlCommand command = new SqlCommand("SELECT * FROM Cars", connection);
                    SqlDataAdapter adapter = new SqlDataAdapter(command);
                    SqlCommandBuilder builder = new SqlCommandBuilder(adapter);
                    //adapter.SelectCommand = command;
                    DataSet dataSet = new DataSet();
                    adapter.Fill(dataSet);

                    DataRow objDR = dataSet.Tables[0].NewRow();
                    objDR["CarMake"] = v.CarMake;
                    objDR["CarModel"] = v.CarModel;
                    objDR["Year"] = v.Year;
                    objDR["ServiceDate"] = v.ServiceDate;
                    dataSet.Tables[0].Rows.Add(objDR);
                    adapter.Update(dataSet);
                    //
                    string query = "SELECT IDENT_CURRENT ('Cars')";
                    adapter.SelectCommand.CommandText = query;
                    DataSet objDS = new DataSet();
                    adapter.Fill(objDS);
                    //
                    if (objDS.Tables[0].Rows.Count > 0)
                    {
                        Console.WriteLine("Car Last ID:");
                        DataRow row = objDS.Tables[0].Rows[0];
                        int carId = Convert.ToInt32( row[0]);
                        Console.WriteLine(row[0]); // This will print the last inserted CarID
                        //Console.WriteLine($"CarID: {row["CarID"]}\tCarMake: {row["CarMake"]}\tCarModel: {row["CarModel"]}\tYear: {row["Year"]}\tService Date: {row["ServiceDate"]}");  
                        Console.WriteLine($"CarID: {carId}\tCarMake: {v.CarMake}\tCarModel: {v.CarModel}\tYear: {v.Year}\tService Date: {v.ServiceDate}");
                    }
                    else
                    {
                        Console.WriteLine("Car Id not found.");
                    }
                    //
                    Console.WriteLine("Car added successfully.");
                }
            }

            public static void ParticipantExamEligibility()
            {
                using (SqlConnection connection = new SqlConnection(connectionString))
                {

                    SqlCommand command = new SqlCommand("SELECT * FROM Participants where MS1ExamPassed='yes'", connection);
                    SqlDataAdapter adapter = new SqlDataAdapter(command);
                    SqlCommandBuilder builder = new SqlCommandBuilder(adapter);
                    adapter.SelectCommand = command;
                    DataSet dataSet = new DataSet();
                    adapter.Fill(dataSet);

                    DataRowCollection objDRs = dataSet.Tables[0].Rows;
                    foreach (DataRow objDR in objDRs)
                    {
                        objDR[2] = "yes";
                    }
                    adapter.Update(dataSet);
                }
            }

            public static void ListCars()
            {

                using (SqlConnection connection = new SqlConnection(connectionString))
                {
                    connection.Open();

                    using (SqlDataAdapter adapter = new SqlDataAdapter("SELECT * FROM Cars", connection))
                    {
                        DataSet dataSet = new DataSet();
                        adapter.Fill(dataSet);

                        if (dataSet.Tables[0].Rows.Count == 0)
                        {
                            Console.WriteLine("No Cars available.");
                            return;
                        }

                        Console.WriteLine("Car List:");
                        foreach (DataRow row in dataSet.Tables[0].Rows)
                        {
                            Console.WriteLine($"CarID: {row["CarID"]}\tCarMake: {row["CarMake"]}\tCarModel: {row["CarModel"]}\tYear: {row["Year"]}\tService Date: {row["ServiceDate"]}");
                        }

                    }
                }
            }

            public static void DeleteCar(int carID)
            {
                SqlConnection conn = new SqlConnection(connectionString);
                string query = "SELECT * FROM Cars";
                SqlDataAdapter da = new SqlDataAdapter(query, conn);
                SqlCommandBuilder builder = new SqlCommandBuilder(da);
                DataSet ds = new DataSet();

                da.Fill(ds, "Cars");

                // Find the row based on the CarID
                DataRow[] rows = ds.Tables["Cars"].Select($"CarID = {carID}");

                if (rows.Length == 1)
                {
                    rows[0].Delete();      // Delete the row if it exists
                    da.Update(ds, "Cars"); // Update the DataSet to reflect the deletion in the database
                    Console.WriteLine("Car deleted successfully.");
                }
                else
                {
                    Console.WriteLine("Car not found.");
                }
            }

            public static void SearchCarWithModel(string carModel)
            {
                SqlConnection conn = new SqlConnection(connectionString);
                string query = "SELECT * FROM Cars where CarModel = @CarModel";
                SqlCommand objCom = new SqlCommand(query, conn);
                objCom.Parameters.AddWithValue("@CarModel", carModel);
                SqlDataAdapter da = new SqlDataAdapter(objCom);
                SqlCommandBuilder builder = new SqlCommandBuilder(da);
                DataSet ds = new DataSet();

                da.Fill(ds, "Cars");

                if (ds.Tables[0].Rows.Count > 0)
                {
                    Console.WriteLine("Car Details:");
                    foreach (DataRow row in ds.Tables[0].Rows)
                    {
                        Console.WriteLine($"CarID: {row["CarID"]}\tCarMake: {row["CarMake"]}\tCarModel: {row["CarModel"]}\tYear: {row["Year"]}\tService Date: {row["ServiceDate"]}");
                    }
                }
                else
                {
                    Console.WriteLine("Car not found.");
                }
            }

            public static void SearchCarWithThreshold(string thresholdValue)
            {
                SqlConnection conn = new SqlConnection(connectionString);
                string query = "SELECT * FROM Cars where year > @ThresholdValue";
                SqlCommand objCom = new SqlCommand(query, conn);
                objCom.Parameters.AddWithValue("@ThresholdValue", thresholdValue);
                SqlDataAdapter da = new SqlDataAdapter(objCom);
                SqlCommandBuilder builder = new SqlCommandBuilder(da);
                DataSet ds = new DataSet();

                da.Fill(ds, "Cars");

                if (ds.Tables[0].Rows.Count > 0)
                {
                    Console.WriteLine("Car Details:");
                    foreach (DataRow row in ds.Tables[0].Rows)
                    {
                        Console.WriteLine($"CarID: {row["CarID"]}\tCarMake: {row["CarMake"]}\tCarModel: {row["CarModel"]}\tYear: {row["Year"]}\tService Date: {row["ServiceDate"]}");
                    }
                }
                else
                {
                    Console.WriteLine("Car not found.");
                }
            }

            public static void SearchCarWithPatternMatching(string pattern)
            {
                SqlConnection conn = new SqlConnection(connectionString);
                string query = "SELECT * FROM Cars where CarMake like @Pattern";
                SqlCommand objCom = new SqlCommand(query, conn);
                objCom.Parameters.AddWithValue("@Pattern", "%" + pattern + "%");
                SqlDataAdapter da = new SqlDataAdapter(objCom);
                SqlCommandBuilder builder = new SqlCommandBuilder(da);
                DataSet ds = new DataSet();

                da.Fill(ds, "Cars");

                if (ds.Tables[0].Rows.Count > 0)
                {
                    Console.WriteLine("Car Details:");
                    foreach (DataRow row in ds.Tables[0].Rows)
                    {
                        Console.WriteLine($"CarID: {row["CarID"]}\tCarMake: {row["CarMake"]}\tCarModel: {row["CarModel"]}\tYear: {row["Year"]}\tService Date: {row["ServiceDate"]}");
                    }
                }
                else
                {
                    Console.WriteLine("Car not found.");
                }
            }

            public static void SearchCarWithServiceDateRange(string serviceStartDate, string serviceEndDate)
            {
                SqlConnection conn = new SqlConnection(connectionString);
                string query = "select * from Cars where serviceDate between @ServiceStartDate and @ServiceEndDate";
                SqlCommand objCom = new SqlCommand(query, conn);
                objCom.Parameters.AddWithValue("@ServiceStartDate", serviceStartDate);
                objCom.Parameters.AddWithValue("@ServiceEndDate", serviceEndDate);
                SqlDataAdapter da = new SqlDataAdapter(objCom);
                SqlCommandBuilder builder = new SqlCommandBuilder(da);
                DataSet ds = new DataSet();

                da.Fill(ds, "Cars");

                if (ds.Tables[0].Rows.Count > 0)
                {
                    Console.WriteLine("Car Details:");
                    foreach (DataRow row in ds.Tables[0].Rows)
                    {
                        Console.WriteLine($"CarID: {row["CarID"]}\tCarMake: {row["CarMake"]}\tCarModel: {row["CarModel"]}\tYear: {row["Year"]}\tService Date: {row["ServiceDate"]}");
                    }
                }
                else
                {
                    Console.WriteLine("Car not found.");
                }
            }

            public static void GetTopRecords(string count)
            {
                SqlConnection conn = new SqlConnection(connectionString);
                string query = "SELECT TOP (@Count) * FROM Cars";
                SqlCommand objCom = new SqlCommand(query, conn);
                objCom.Parameters.AddWithValue("@Count", count);
                /*
                string sortBy = "CarModel";
                string sortDirection = "desc";
                string query = $"select * from cars order by {sortBy} {sortDirection}";
                
                SqlCommand objCom = new SqlCommand(query, conn);
                */
                SqlDataAdapter da = new SqlDataAdapter(objCom);
                SqlCommandBuilder builder = new SqlCommandBuilder(da);
                DataSet ds = new DataSet();

                da.Fill(ds, "Cars");

                if (ds.Tables[0].Rows.Count > 0)
                {
                    Console.WriteLine("Car Details:");
                    foreach (DataRow row in ds.Tables[0].Rows)
                    {
                        Console.WriteLine($"CarID: {row["CarID"]}\tCarMake: {row["CarMake"]}\tCarModel: {row["CarModel"]}\tYear: {row["Year"]}\tService Date: {row["ServiceDate"]}");
                    }
                }
                else
                {
                    Console.WriteLine("Car not found.");
                }
            }

            public static void GetBottomRecords(int count)
            {
                SqlConnection conn = new SqlConnection(connectionString);
                string query = "SELECT TOP (@Count) * FROM Cars order by CarID desc";
                SqlCommand objCom = new SqlCommand(query, conn);
                objCom.Parameters.AddWithValue("@Count", count);
                SqlDataAdapter da = new SqlDataAdapter(objCom);
                SqlCommandBuilder builder = new SqlCommandBuilder(da);
                DataSet ds = new DataSet();

                da.Fill(ds, "Cars");

                if (ds.Tables[0].Rows.Count > 0)
                {
                    Console.WriteLine("Car Details:");
                    foreach (DataRow row in ds.Tables[0].Rows)
                    {
                        Console.WriteLine($"CarID: {row["CarID"]}\tCarMake: {row["CarMake"]}\tCarModel: {row["CarModel"]}\tYear: {row["Year"]}\tService Date: {row["ServiceDate"]}");
                    }
                }
                else
                {
                    Console.WriteLine("Car not found.");
                }
            }

            //----Not Used----
            public static void SearchCarWithMake_Option1(string carMake)
            {
                SqlConnection conn = new SqlConnection(connectionString);
                string query = "SELECT * FROM Cars";
                SqlCommand objCom = new SqlCommand(query, conn);
                SqlDataAdapter da = new SqlDataAdapter(objCom);
                SqlCommandBuilder builder = new SqlCommandBuilder(da);
                DataSet ds = new DataSet();

                da.Fill(ds, "Cars");

                // Find the row based on the CarID
                string safeCarMake = carMake.Replace("'", "''"); // escape single quotes
                //DataRow[] rows = ds.Tables["Cars"].Select($"CarMake = '{safeCarMake}'");
                DataRow[] rows = ds.Tables["Cars"].Select("CarModel = '" + carMake + "'");

                if (rows.Length > 0)
                {
                    Console.WriteLine("Car Details:");
                    foreach (DataRow row in rows)
                    {
                        Console.WriteLine($"CarID: {row["CarID"]}\tCarMake: {row["CarMake"]}\tCarModel: {row["CarModel"]}\tYear: {row["Year"]}\tService Date: {row["ServiceDate"]}");
                    }
                }
                else
                {
                    Console.WriteLine("Car not found.");
                }
            }
        }
    }
}